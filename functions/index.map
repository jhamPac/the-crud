{"version":3,"sources":["firebaseSingleton.js","graphql/resolvers.js","graphql/schema.js","source.js"],"names":["admin","require","functions","initializeApp","config","firebase","resolveFunctions","foodDoc","foodInfo","FOOD_REF","get","catch","err","Error","data","Object","keys","reduce","info","acc","key","index","foodItem","name","inStock","concat","foodSupply","root","payload","update","addFoodToSupply","fireStore","firestore","collection","doc","Query","Mutation","typeDefs","gql","resolvers","gqlServer","ApolloServer","schema","playground","api","https","onRequest","createHandler","cors","origin"],"mappings":"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","file":"index.map","sourceRoot":"","sourcesContent":["const admin     = require('firebase-admin')\nconst functions = require('firebase-functions')\n\n// FireBase setup\nadmin.initializeApp(functions.config().firebase)\n\nexport { admin, functions }\n","import { admin } from '../firebaseSingleton'\n\nconst fireStore = admin.firestore()\nconst FOOD_REF  = fireStore.collection('provisions').doc('food')\n\nasync function foodSupply() {\n  const foodDoc = await FOOD_REF.get().catch(err => {\n    throw new Error(err)\n  })\n\n  const foodInfo       = foodDoc.data()\n  const createFoodItem = info => (acc, key, index) => {\n    let foodItem = {\n      name: key,\n      inStock: info[key]['inStock']\n    }\n\n    return acc.concat(foodItem)\n  }\n\n  return Object.keys(foodInfo).reduce(createFoodItem(foodInfo), [])\n}\n\nasync function addFoodToSupply(root, { name, inStock }) {\n  const payload = {\n    [name]: {\n      inStock\n    }\n  }\n\n  await FOOD_REF.update(payload)\n  payload.name = name\n\n  return payload\n}\n\n\nconst resolveFunctions = {\n  Query: {\n    foodSupply\n  },\n\n  Mutation: {\n    addFoodToSupply\n  }\n}\n\nexport default resolveFunctions\n","import { gql } from 'apollo-server-cloud-functions'\n\nimport resolvers from \"./resolvers\"\n\nconst typeDefs = gql`\n  type Food {\n    id: ID!\n    name: String\n    inStock: Int\n  }\n\n  # the schema allows the following query:\n  type Query {\n    foodSupply: [Food]\n  }\n\n  # this schema allows the following mutation:\n  type Mutation {\n    addFoodToSupply(name: String!, inStock: Int!): Food\n  }\n`\n\nexport default {\n  typeDefs,\n  resolvers\n}\n","import { functions } from './firebaseSingleton'\n\n// GraphQL\nimport { ApolloServer }   from 'apollo-server-cloud-functions'\nimport schema             from './graphql/schema'\n\nconst gqlServer = new ApolloServer({\n  ...schema,\n  playground: true\n})\n\n// export Firebase function handler\nexport const api = functions.https.onRequest(gqlServer.createHandler({\n  cors: {\n    origin: '*'\n  }\n}))\n"]}